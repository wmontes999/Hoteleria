Aes.Ctr={};Aes.Ctr.encrypt=function(j,a,t){var k=16;if(!(t==128||t==192||t==256)){return""}j=Utf8.encode(j);a=Utf8.encode(a);var l=t/8;var f=new Array(l);for(var r=0;r<l;r++){f[r]=isNaN(a.charCodeAt(r))?0:a.charCodeAt(r)}var y=Aes.cipher(f,Aes.keyExpansion(f));y=y.concat(y.slice(0,l-16));var e=new Array(k);var s=(new Date()).getTime();var d=Math.floor(s/1000);var g=s%1000;for(var r=0;r<4;r++){e[r]=(d>>>r*8)&255}for(var r=0;r<4;r++){e[r+4]=g&255}var n="";for(var r=0;r<8;r++){n+=String.fromCharCode(e[r])}var v=Aes.keyExpansion(y);var q=Math.ceil(j.length/k);var m=new Array(q);for(var w=0;w<q;w++){for(var u=0;u<4;u++){e[15-u]=(w>>>u*8)&255}for(var u=0;u<4;u++){e[15-u-4]=(w/4294967296>>>u*8)}var h=Aes.cipher(e,v);var p=w<q-1?k:(j.length-1)%k+1;var o=new Array(p);for(var r=0;r<p;r++){o[r]=h[r]^j.charCodeAt(w*k+r);o[r]=String.fromCharCode(o[r])}m[w]=o.join("")}var x=n+m.join("");x=Base64.encode(x);return x};Aes.Ctr.decrypt=function(t,e,p){var m=16;if(!(p==128||p==192||p==256)){return""}t=Base64.decode(t);e=Utf8.encode(e);var n=p/8;var j=new Array(n);for(var o=0;o<n;o++){j[o]=isNaN(e.charCodeAt(o))?0:e.charCodeAt(o)}var u=Aes.cipher(j,Aes.keyExpansion(j));u=u.concat(u.slice(0,n-16));var f=new Array(8);ctrTxt=t.slice(0,8);for(var o=0;o<8;o++){f[o]=ctrTxt.charCodeAt(o)}var r=Aes.keyExpansion(u);var g=Math.ceil((t.length-8)/m);var h=new Array(g);for(var s=0;s<g;s++){h[s]=t.slice(8+s*m,8+s*m+m)}t=h;var a=new Array(t.length);for(var s=0;s<g;s++){for(var q=0;q<4;q++){f[15-q]=((s)>>>q*8)&255}for(var q=0;q<4;q++){f[15-q-4]=(((s+1)/4294967296-1)>>>q*8)&255}var l=Aes.cipher(f,r);var d=new Array(t[s].length);for(var o=0;o<t[s].length;o++){d[o]=l[o]^t[s].charCodeAt(o);d[o]=String.fromCharCode(d[o])}a[s]=d.join("")}var k=a.join("");k=Utf8.decode(k);return k};